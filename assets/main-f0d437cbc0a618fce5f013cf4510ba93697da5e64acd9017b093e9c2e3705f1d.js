function Utils(){}function trySetIframeSrc(t){var e=Utils.isElementInView(t,!1);if(e){var n=t.data("src");"undefined"!=typeof n&&(t.attr("src",n),t.removeData("src"))}}function detectIframeInView(){$(".post-content > iframe").each(function(){trySetIframeSrc($(this))})}function addToTop(){$("#toTop").length>0&&$("#toTop").remove(),0==$("#disqus_thread").length?$(".page-content").after("<div id='toTop'><a href='#'>\u25b2</a></div>"):$("#disqus_thread").before("<div id='toTop'><a href='#'>\u25b2</a></div>")}Utils.prototype={constructor:Utils,isElementInView:function(t,e){var n=$(window).scrollTop(),o=n+$(window).height(),i=$(t).offset().top,a=i+$(t).height();return e===!0?n<i&&o>a:i<=o&&a>=n}};var Utils=new Utils;$(document).ready(function(){function t(t,n){$("html, body").stop().animate({scrollTop:0},"500","swing",function(){document.title=$(t).filter("title").text(),n.css("opacity",0),e.checked?TongWen.trans2Trad(document):TongWen.trans2Simp(document),$(".page-content").after(n),$(".page-content").animate({marginTop:"1.5em",opacity:0},600,function(){$(this).remove(),$(".page-content-clone").css("margin-top","1.5em").animate({marginTop:"0em",opacity:1},600,function(){$(this).addClass("page-content").removeClass("page-content-clone"),addToTop()})})})}detectIframeInView(),addToTop();var e=document.querySelector("#ts-switch"),n=document.querySelector("#side-label"),o=(new Switchery(e),null);$(window).on("scroll",function(){o&&clearTimeout(o),o=setTimeout(detectIframeInView,500)}),$("body").on("click","#toTop",function(t){t.preventDefault(),t.stopImmediatePropagation(),$("html, body").stop().animate({scrollTop:0},"500","swing")}),$("body").on("click",'.post-link, .site-title, .page-link, a[href^="/"]',function(e){e.preventDefault(),e.stopImmediatePropagation();var n=$(this).attr("href");history.pushState(null,n,n);var o=$(".page-content").clone();o.addClass("page-content-clone").removeClass("page-content"),$.ajax({url:$(this).attr("href"),success:function(e){var n=$(e).filter(".page-content").find(".wrapper");n.find("iframe").each(function(){$(this).data("src",$(this).attr("src")),$(this).attr("src","")}),o.html(n),t(e,o)}})}),History.Adapter.bind(window,"popstate",function(){$(".page-content").load(document.location.href+" .page-content > .wrapper",function(t){document.title=$(t).filter("title").text()})}),$("body").on("mouseenter",".post-list a",function(){$(this).next(".home-post-meta").animate({marginLeft:"0em",opacity:1})}),$("body").on("touchstart",".post-list li",function(){$(this).find(".home-post-meta").animate({marginLeft:"0em",opacity:1})}),$("body").on("mouseleave",".post-list a",function(){$(this).next(".home-post-meta").animate({marginLeft:"-1em",opacity:0})}),$("body").on("touchend",".post-list li",function(){$(this).find(".home-post-meta").animate({marginLeft:"-1em",opacity:0})}),e.onchange=function(){e.checked?(TongWen.trans2Trad(document),n.innerHTML="\u7e41"):(TongWen.trans2Simp(document),n.innerHTML="\u7b80")}});